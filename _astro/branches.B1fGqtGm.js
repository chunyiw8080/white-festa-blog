import{o as e,_ as t,a3 as s,$ as n,J as o,Q as i,n as c,L as f,ab as r,S as a}from"./template.u955vnAV.js";class h{anchor;#e=new Map;#t=new Map;#s=new Map;#n=new Set;#o=!0;constructor(e,t=!0){this.anchor=e,this.#o=t}#i=()=>{var i=e;if(this.#e.has(i)){var c=this.#e.get(i),f=this.#t.get(c);if(f)t(f),this.#n.delete(c);else{var a=this.#s.get(c);a&&(this.#t.set(c,a.effect),this.#s.delete(c),a.fragment.lastChild.remove(),this.anchor.before(a.fragment),f=a.effect)}for(const[e,t]of this.#e){if(this.#e.delete(e),e===i)break;const n=this.#s.get(t);n&&(s(n.effect),this.#s.delete(t))}for(const[e,t]of this.#t){if(e===c||this.#n.has(e))continue;const i=()=>{if(Array.from(this.#e.values()).includes(e)){var n=document.createDocumentFragment();r(t,n),n.append(o()),this.#s.set(e,{effect:t,fragment:n})}else s(t);this.#n.delete(e),this.#t.delete(e)};this.#o||!f?(this.#n.add(e),n(t,i,!1)):i()}}};#c=e=>{this.#e.delete(e);const t=Array.from(this.#e.values());for(const[n,o]of this.#s)t.includes(n)||(s(o.effect),this.#s.delete(n))};ensure(t,s){var n=e,r=a();if(s&&!this.#t.has(t)&&!this.#s.has(t))if(r){var h=document.createDocumentFragment(),m=o();h.append(m),this.#s.set(t,{effect:i(()=>s(m)),fragment:h})}else this.#t.set(t,i(()=>s(this.anchor)));if(this.#e.set(n,t),r){for(const[e,s]of this.#t)e===t?n.unskip_effect(s):n.skip_effect(s);for(const[e,s]of this.#s)e===t?n.unskip_effect(s.effect):n.skip_effect(s.effect);n.oncommit(this.#i),n.ondiscard(this.#c)}else c&&(this.anchor=f),this.#i()}}export{h as B};
